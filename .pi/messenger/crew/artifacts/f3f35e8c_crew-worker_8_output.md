Let me look at the issue more carefully by examining what messages are being received. Let me refactor these tests to handle messages in the right order: