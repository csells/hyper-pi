Now let me read the relevant files to understand the current implementation: